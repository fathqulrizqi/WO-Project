<!doctype html>
@{
    ViewBag.Title = "D365 Excel Form";
    Layout = "~/Views/Shared/_Layout.cshtml";

    var currUser = ViewBag.CurrUser;
}

<!-- Canonical SEO -->
@*<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css">*@
@*<link href="@Url.Content("~/Content/fresh-bootstrap-table/css/fresh-bootstrap-table.css")" rel="stylesheet" />*@
<link href="@Url.Content("~/Content/bootstrap-table/bootstrap-table.min.css")" rel="stylesheet">
<link href="@Url.Content("~/Content/datepicker/datepicker.css")" rel="stylesheet" />
<!--   Fonts and icons   -->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
<link href="http://fonts.googleapis.com/css?family=Roboto:400,700,300" rel="stylesheet" type="text/css">

@*<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js"></script>*@
<script src="@Url.Content("~/Content/bootstrap-table/bootstrap-table.min.js")"></script>
<script src="@Url.Content("~/Content/bootstrap-table/bootstrap-table-toolbar.min.js")"</script>
<script src="@Url.Content("~/Content/bootstrap-table/tableExport.min.js")"></script>
<script src="@Url.Content("~/Content/bootstrap-table/bootstrap-table-export.min.js")"></script>
<script src="@Url.Content("~/Content/bootstrap-table/filter-control/bootstrap-table-filter-control.min.js")"></script>
<script src="@Url.Content("~/Content/datepicker/datepicker.js")"></script>
<style>
    body {
        font-size: 0.9rem;
    }

    .card-header {
        font-size: 1rem;
        color: white;
    }

    .card a {
        text-decoration: none;
        color: white;
    }

        .card a:hover {
            text-decoration: none;
            font;
        }

    .card-header .fa {
        transition: .3s transform ease-in-out;
    }

    .card-header .collapsed .fa {
        transform: rotate(90deg);
    }


    /* spinner */
    *.hidden {
        display: none !important;
    }

    div.loading {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(16, 16, 16, 0.5);
        z-index: 1000;
    }

    @@-webkit-keyframes uil-ring-anim {
        0% {
            -ms-transform: rotate(0deg);
            -moz-transform: rotate(0deg);
            -webkit-transform: rotate(0deg);
            -o-transform: rotate(0deg);
            transform: rotate(0deg);
        }

        100% {
            -ms-transform: rotate(360deg);
            -moz-transform: rotate(360deg);
            -webkit-transform: rotate(360deg);
            -o-transform: rotate(360deg);
            transform: rotate(360deg);
        }
    }

    @@-webkit-keyframes uil-ring-anim {
        0% {
            -ms-transform: rotate(0deg);
            -moz-transform: rotate(0deg);
            -webkit-transform: rotate(0deg);
            -o-transform: rotate(0deg);
            transform: rotate(0deg);
        }

        100% {
            -ms-transform: rotate(360deg);
            -moz-transform: rotate(360deg);
            -webkit-transform: rotate(360deg);
            -o-transform: rotate(360deg);
            transform: rotate(360deg);
        }
    }

    @@-moz-keyframes uil-ring-anim {
        0% {
            -ms-transform: rotate(0deg);
            -moz-transform: rotate(0deg);
            -webkit-transform: rotate(0deg);
            -o-transform: rotate(0deg);
            transform: rotate(0deg);
        }

        100% {
            -ms-transform: rotate(360deg);
            -moz-transform: rotate(360deg);
            -webkit-transform: rotate(360deg);
            -o-transform: rotate(360deg);
            transform: rotate(360deg);
        }
    }

    @@-ms-keyframes uil-ring-anim {
        0% {
            -ms-transform: rotate(0deg);
            -moz-transform: rotate(0deg);
            -webkit-transform: rotate(0deg);
            -o-transform: rotate(0deg);
            transform: rotate(0deg);
        }

        100% {
            -ms-transform: rotate(360deg);
            -moz-transform: rotate(360deg);
            -webkit-transform: rotate(360deg);
            -o-transform: rotate(360deg);
            transform: rotate(360deg);
        }
    }

    @@-moz-keyframes uil-ring-anim {
        0% {
            -ms-transform: rotate(0deg);
            -moz-transform: rotate(0deg);
            -webkit-transform: rotate(0deg);
            -o-transform: rotate(0deg);
            transform: rotate(0deg);
        }

        100% {
            -ms-transform: rotate(360deg);
            -moz-transform: rotate(360deg);
            -webkit-transform: rotate(360deg);
            -o-transform: rotate(360deg);
            transform: rotate(360deg);
        }
    }

    @@-webkit-keyframes uil-ring-anim {
        0% {
            -ms-transform: rotate(0deg);
            -moz-transform: rotate(0deg);
            -webkit-transform: rotate(0deg);
            -o-transform: rotate(0deg);
            transform: rotate(0deg);
        }

        100% {
            -ms-transform: rotate(360deg);
            -moz-transform: rotate(360deg);
            -webkit-transform: rotate(360deg);
            -o-transform: rotate(360deg);
            transform: rotate(360deg);
        }
    }

    @@-o-keyframes uil-ring-anim {
        0% {
            -ms-transform: rotate(0deg);
            -moz-transform: rotate(0deg);
            -webkit-transform: rotate(0deg);
            -o-transform: rotate(0deg);
            transform: rotate(0deg);
        }

        100% {
            -ms-transform: rotate(360deg);
            -moz-transform: rotate(360deg);
            -webkit-transform: rotate(360deg);
            -o-transform: rotate(360deg);
            transform: rotate(360deg);
        }
    }

    @@keyframes uil-ring-anim {
        0% {
            -ms-transform: rotate(0deg);
            -moz-transform: rotate(0deg);
            -webkit-transform: rotate(0deg);
            -o-transform: rotate(0deg);
            transform: rotate(0deg);
        }

        100% {
            -ms-transform: rotate(360deg);
            -moz-transform: rotate(360deg);
            -webkit-transform: rotate(360deg);
            -o-transform: rotate(360deg);
            transform: rotate(360deg);
        }
    }

    .uil-ring-css {
        margin: auto;
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        width: 200px;
        height: 200px;
    }

        .uil-ring-css > div {
            position: absolute;
            display: block;
            width: 160px;
            height: 160px;
            top: 20px;
            left: 20px;
            border-radius: 80px;
            box-shadow: 0 6px 0 0 #ffffff;
            -ms-animation: uil-ring-anim 1s linear infinite;
            -moz-animation: uil-ring-anim 1s linear infinite;
            -webkit-animation: uil-ring-anim 1s linear infinite;
            -o-animation: uil-ring-anim 1s linear infinite;
            animation: uil-ring-anim 1s linear infinite;
        }
</style>


<div class="loading" style="display:none">
    <div class='uil-ring-css' style='transform:scale(0.79);'>

    </div>
</div>
<div class="row">

    <div class="col-12">

        <div class="card">
            <div class="card-header bg-danger">
                <a class="collapsed d-block" data-toggle="collapse" href="#collapse-collapsed-salesOrderLilnes" aria-expanded="true" aria-controls="collapse-collapsed" id="heading-collapsed">
                    Standard Cost

                </a>

            </div>
            <form action="@Url.Action("uploadStockManagementV2", "D365ImportForm", new { area = "IT" })" method="post" enctype="multipart/form-data" id="FormStockManagementV2">
                <div id="collapse-collapsed-standardCost" class="collapse show" aria-labelledby="heading-collapsed">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-12">

                                <div class="form-group row">
                                    <label for="" class="col-sm-4 col-form-label">Upload Stock Management V2</label>
                                    <div class="col-sm-8">
                                        <input type="file" name="fileExcel" class="form-control col-sm-6" id="inputFile" required>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer">
                        <button class="btn btn-primary" type="submit">Impor</button>
                    </div>
                </div>
            </form>
            <div class="form-group mt-3" id="processStandardCost" style="display:none">
                <div class="progress">
                    <div class="progress-bar progress-bar-striped active bg-danger" role="progressbar">

                    </div>
                </div>
                <span id="process_data_standard_cost"></span>
            </div>
        </div>
    </div>

</div>
<script>
    $(document).ready(function () {
        $('#FormStockManagementV2').on('submit', (function (e) {
                e.preventDefault();
                var formData = new FormData(this);
                var urlAction  = "@Url.Action("uploadStockManagementV2", "D365ImporForm", new { area = "IT" })";
                var TableViewAction;
                $.ajax({
                    type: 'POST',
                    url: urlAction,
                    data: formData,
                    cache: false,
                    contentType: false,
                    processData: false,
                    beforeSend: function () {
                        //$('.loading').css("display", "");
                        $('.btn').prop('disabled', true);
                    },
                    success: function (json) {
                        //$('.loading').css("display", "");
                        if (json.status == 1) {
                            //$('.loading').css("display", "none");
                            $('.btn').prop('disabled', false);
                            if (dataimport == 1) {
                                alert("success");
                            }
                        }
                    },
                    error: function (data) {
                        console.log("error");
                        swal("Failed!", json.msg, "error");
                    }
                });
            }));

    })
</script>
